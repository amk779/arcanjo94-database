<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARCANJO 94 - Sistema de Consulta Oficial</title>
    <style>
        /* (Todo seu CSS permanece o mesmo e está ótimo!) */
    </style>
</head>
<body>
    <!-- Cabeçalho -->
    <header class="government-header">
        <img src="https://via.placeholder.com/60x60?text=BRASÃO" alt="Brasão Oficial" class="official-logo">
        <div class="header-titles">
            <h1 class="main-title">SISTEMA ARCÂNJO 94</h1>
            <p class="subtitle">Banco de Dados Integrado de Segurança Pública</p>
        </div>
    </header>

    <div class="security-warning">
        ATENÇÃO: Este sistema é de uso restrito e seu acesso está sendo monitorado (Lei 12.737/2012)
    </div>

    <!-- Área de busca -->
    <main class="search-section">
        <div class="search-container">
            <div class="search-header">
                <h2 class="search-title">CONSULTA DE REGISTROS</h2>
                <p>Utilize CPF ou Nome Completo para pesquisa</p>
            </div>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Digite o número do CPF ou Nome completo...">
                <button id="searchButton">Consultar</button>
            </div>
            <div id="results" class="results"></div>
        </div>
    </main>

    <!-- Rodapé -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3 class="footer-title">Acesso Autorizado</h3>
                <p>Sistema regulamentado pelo Decreto nº 9.845/2019</p>
                <p>Credenciamento: Portaria 1456/2024</p>
            </div>
            <div class="footer-section">
                <h3 class="footer-title">Suporte Técnico</h3>
                <p>Central de Atendimento: (21) 9999-9999</p>
                <p>Email: suporte@arcanjo94.gov.br</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        const SPREADSHEET_ID = '13jF2CxAHCk-YDjyKg-tpzzKc99xiLt5lZc8kHmKvQeo';
        const PLANILHA_URL = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json`;

        async function buscarDados() {
            const termo = document.getElementById('searchInput').value.trim().toLowerCase();
            const resultsDiv = document.getElementById('results');

            if (!termo) {
                alert('Digite um nome ou CPF para buscar.');
                return;
            }

            try {
                const resposta = await fetch(PLANILHA_URL);
                const texto = await resposta.text();
                const json = JSON.parse(texto.substr(47).slice(0, -2));

                const linha = json.table.rows.find(row =>
                    row.c[0]?.v?.toLowerCase().includes(termo) || 
                    row.c[1]?.v?.toLowerCase().includes(termo)
                );

                resultsDiv.innerHTML = linha ? criarTemplate(linha) : '<p class="no-results">Nenhum registro encontrado.</p>';
                resultsDiv.style.display = 'block';

            } catch (e) {
                resultsDiv.innerHTML = '<p class="error">Erro na conexão com o banco de dados.</p>';
                resultsDiv.style.display = 'block';
                console.error(e);
            }
        }

        function criarTemplate(linha) {
            return `
                <div class="profile-card">
                    <div>
                        <img src="${linha.c[5]?.v || 'https://via.placeholder.com/200x300?text=Foto+Indisponível'}" 
                             class="profile-photo" 
                             alt="Foto do Registrado">
                    </div>
                    <div class="profile-info">
                        <h3 class="profile-section-title">DADOS CADASTRAIS</h3>
                        <div class="data-field"><span class="field-label">CPF:</span><span class="field-value">${linha.c[0]?.v || 'Não informado'}</span></div>
                        <div class="data-field"><span class="field-label">Nome Completo:</span><span class="field-value">${linha.c[1]?.v || 'Não informado'}</span></div>
                        <div class="data-field"><span class="field-label">Local de Atuação:</span><span class="field-value">${linha.c[2]?.v || 'Não informado'}</span></div>

                        <h3 class="profile-section-title">INFORMAÇÕES OPERACIONAIS</h3>
                        <div class="data-field"><span class="field-label">Grupo/Membro:</span><span class="field-value">${linha.c[3]?.v || 'Não informado'}</span></div>
                        <div class="data-field"><span class="field-label">Última Situação:</span><span class="field-value">${linha.c[4]?.v || 'Não informado'}</span></div>
                    </div>
                </div>
            `;
        }

        document.getElementById('searchButton').addEventListener('click', buscarDados);
        document.getElementById('searchInput').addEventListener('keypress', e => {
            if (e.key === 'Enter') buscarDados();
        });
    </script>
</body>
</html>
